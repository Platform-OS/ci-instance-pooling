{% liquid
  if client == blank
    log 'client is blank. Cowardly refusing to proceed with searching'
    return null
  endif

  if id == blank
    log 'id is blank. Cowardly refusing to proceed with searching'
    return null
  endif

  log available, type: 'available'

  graphql r = 'instances/search', limit: 1, id: id, reserved_by: client, available: false
  include 'lib/handle_graphql_response', r: r, name: 'queries/instances/search'

  return r.records.results.first
%}
